<!DOCTYPE html>
<html>
<head>
    <title>Residential Hub</title>
    <style>
        body { font-family: -apple-system, sans-serif; padding: 40px; max-width: 800px; margin: auto; }
        .card { border: 1px solid #eee; padding: 20px; border-radius: 10px; margin-top: 20px; box-shadow: 0 2px 5px rgba(0,0,0,0.05); }
        .btn { background: #2ea44f; color: white; padding: 10px 20px; text-decoration: none; border-radius: 5px; display: inline-block; }
        .edit-link { float: right; color: #0969da; text-decoration: none; font-size: 0.9em; }
    </style>
</head>
<body>
    <h1>üè° Community Source of Truth</h1>
    <p>Structured, version-controlled information for our residents.</p>
    
    <a href="./admin/#/collections/clusters/new" class="btn">+ Add New Area</a>

    <div id="directory">Loading Clusters...</div>

    <script>
        // REPLACE THESE with your actual GitHub info
        const USER = 'dekumar2-lab'; 
        const REPO = 'community-hub'; 

        async function fetchClusters() {
            const container = document.getElementById('directory');
            try {
                const res = await fetch(`https://api.github.com/repos/${USER}/${REPO}/contents/clusters`);
                const files = await res.json();
                container.innerHTML = '';
                
                files.forEach(file => {
                    if(file.name.endsWith('.md')) {
                        const name = file.name.replace('.md', '').replace(/-/g, ' ');
                        const div = document.createElement('div');
                        div.className = 'card';
                        div.innerHTML = `
                            <a href="./admin/#/edit/clusters/${file.name.replace('.md', '')}" class="edit-link">Edit Info</a>
                            <h3>${name.toUpperCase()}</h3>
                            <p>Click edit to update information for this cluster.</p>
                        `;
                        container.appendChild(div);
                    }
                });
            } catch (e) {
                container.innerHTML = 'Add your first cluster via the "Add New Area" button above.';
            }
        }
        fetchClusters();
    </script>
</body>
</html>
