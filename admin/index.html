<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Community Source of Truth</title>
    <style>
        body { font-family: sans-serif; line-height: 1.6; max-width: 800px; margin: 40px auto; padding: 20px; color: #333; }
        h1 { border-bottom: 2px solid #eee; padding-bottom: 10px; }
        .cluster-card { border: 1px solid #ddd; padding: 15px; margin-bottom: 20px; border-radius: 8px; position: relative; }
        .edit-link { position: absolute; top: 15px; right: 15px; background: #f4f4f4; padding: 5px 10px; text-decoration: none; border-radius: 4px; font-size: 0.8em; color: #666; }
        .edit-link:hover { background: #e0e0e0; }
        .add-btn { display: inline-block; background: #2ea44f; color: white; padding: 10px 20px; text-decoration: none; border-radius: 6px; font-weight: bold; margin-bottom: 30px; }
    </style>
</head>
<body>

    <h1>üè° Residential Information Hub</h1>
    <p>The version-controlled source of truth for our community.</p>
    
    <a href="./admin/#/collections/clusters/new" class="add-btn">+ Add New Area/Cluster</a>

    <div id="directory">Loading community data...</div>

    <script>
        const USER = 'YOUR_GITHUB_USERNAME'; // Change this
        const REPO = 'YOUR_REPO_NAME';       // Change this

        async function loadDirectory() {
            const container = document.getElementById('directory');
            try {
                // 1. Fetch the list of files in the /clusters folder
                const response = await fetch(`https://api.github.com/repos/${USER}/${REPO}/contents/clusters`);
                const files = await response.json();

                container.innerHTML = ''; // Clear loading text

                for (const file of files) {
                    if (file.name.endsWith('.md')) {
                        const clusterName = file.name.replace('.md', '').replace(/-/g, ' ');
                        const slug = file.name.replace('.md', '');

                        // 2. Create a card for each cluster
                        const card = document.createElement('div');
                        card.className = 'cluster-card';
                        card.innerHTML = `
                            <h3>${clusterName.toUpperCase()}</h3>
                            <p>Information for this residential sector.</p>
                            <a href="./admin/#/edit/clusters/${slug}" class="edit-link">‚úèÔ∏è Edit this Page</a>
                        `;
                        container.appendChild(card);
                    }
                }
            } catch (e) {
                container.innerHTML = 'Error loading directory. Ensure your "clusters" folder exists.';
            }
        }

        loadDirectory();
    </script>
</body>
</html>
